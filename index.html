<!doctype html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<title>git Gud!</title>
	<link rel="stylesheet" href="css/reveal.css">
	<link rel="stylesheet" href="css/theme/beige.css" id="theme">
	<link rel="stylesheet" href="css/custom.css">
	<link rel="stylesheet" type="text/css" href="lib/gitgraph/gitgraph.css" />

	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/styles/solarized-light.min.css">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/highlight.min.js"></script>
	<script src="lib/gitgraph/gitgraph.min.js"></script>
</head>

<body>
	<div class="reveal">
		<div class="slides">
			<section>
				<!-- Intro -->
				<section>
					<h2>git</h2>
					<img src="img/git_logo.png" class="plain" width="300">
					<aside class="notes">
						Git was created by Linus Torvalds in 2005 for development of the Linux kernel, with other kernel developers
						contributing to its initial development.
						(Wikipedia)
					</aside>
				</section>
				<section>
					<h2>Plan</h2>
					<ul>
						<li>La ligne de commande</li>
						<li>Les clients Git</li>
						<li>Il y a quoi sous le capot ? (.git/)</li>
						<li>Pimp My Git!</li>
						<li>Quelques scénarios</li>
						<li>Les outils autour de git</li>
						<li>REX et bonnes pratiques</li>
						<li>Dissection d'un commit (si on a le temps)</li>
					</ul>
				</section>
				<section>
					<h2>Notre base</h2>
					<img class="plain strech" src="img/flow.svg" />
					<aside class="notes">
					</aside>
				</section>
				<section>
					<h2>It's time to ...</h2>
					<img class="plain" src="img/git-gud.gif">
				</section>
			</section>

			<!-- Git en ligne de commande -->
			<!-- TODO : Ajouter les commandes et les graphs de google drive  -->
			<section>
				<section>
					<h2>Git en ligne de commande</h2>
				</section>
				<section data-transition="none">
					<h2>Commits et branches</h2>
					<img class="plain strech" src="img/flow.svg" />
					<aside class="notes">
					</aside>
				</section>
				<section data-transition="none">
					<h2>Rebase</h2>
					<pre><code>git rebase master</code></pre>
					<img class="plain strech" src="img/rebase1.svg" />
					<aside class="notes">
					</aside>
				</section>
				<section data-transition="none">
					<h2>Rebase</h2>
					<img class="plain strech" src="img/rebase2.svg" />
					<aside class="notes">
					</aside>
				</section>
				<section data-transition="none">
					<h2>Rebase</h2>
					<img class="plain strech" src="img/rebase3.svg" />
					<aside class="notes">
					</aside>
				</section>
				<section>
					<h2>Intéractif</h2>
					<pre><code>git rebase -i master</code></pre>
					<pre><code>pick 1 Start my branch1
pick 2 Continue my branch1
</code></pre>
					<aside class="notes">
						<ul>
							<li>pick</li>
							<li>reword</li>
							<li>squash</li>
							<li>edit</li>
							<li>drop</li>
						</ul>
					</aside>
				</section>
				<section>
					<h2>Intéractif</h2>
					<img class="plain strech" src="img/rebasei.svg" />
					<aside class="notes">
						<ul>
							<li>pick</li>
							<li>reword</li>
							<li>squash</li>
							<li>edit</li>
							<li>drop</li>
						</ul>
					</aside>
				</section>
				<section>
					<h2>Journal de références</h2>
					<pre><code>git reflog</code></pre>
					<pre><code>0f8dde4 HEAD@{0}: rebase -i (finish): returning to refs/heads/master
0f8dde4 HEAD@{1}: rebase -i (squash): first + third
606813c HEAD@{2}: rebase -i (start): checkout f07ec95
b8fed7c HEAD@{3}: commit: third
e3025b3 HEAD@{4}: commit: second
606813c HEAD@{5}: commit: first
f07ec95 HEAD@{6}: commit (initial): initial</code></pre>
				</section>
			</section>

			<!-- Il y a quoi sous le capot ? -->
			<section>
				<section>
					<h2>Il y a quoi sous le capot ?</h2>
				</section>
				<section data-transition="none">
					<h2>.git/</h2>
					<aside class="notes">
						Montrer un repo tout juste initialisé.
						Comparer avec un repo existant avec un historique.

						.git/ (On touche avec les yeux !)
						Tout ce dont git a besoin pour gérer in Configuration local au repository

						hooks/
						- Les hooks permettent d'augmenter git et lui rajoutant des fonctions déclenchées
						par des évenements (commit, push ...).
						- Montrer un des exemples de hooks/truc.sample

						info/
						- Dossier peu intéressant. Il contient permettant de faire des exclusions locales.

						logs/
						- historique de tous ce qu'il se passe sur le répo
						- Utiliser la commande reflog

						objects/
						- La "base de données" de git
						- Fragile ! NE PAS TOUCHER !
						- Est utiliser par le garbage collector de git

						refs/
						- Références nommées du repo git
						- stash, branches locales, branches remotes, tags
						- Faire un cat sur un des fichiers et y voir l'Id du commit

						config

						description

						HEAD

						index (Gère la zone de staging)

						packed-refs (Références dormantes de refs utilisé par le garbage collector)
					</aside>
				</section>
			</section>

			<!-- Les clients graphiques pour Git -->
			<section>
				<section>
					<h2 style="color: #5d5d5d;">Les GUI pour Git</h2>
				</section>
				<section>
					<h3 style="color: #5d5d5d;">SourceTree</h3>
				</section>
				<section data-background="img/sourceTree.png" data-background-size="98%">
				</section>
				<section>
					<h3 style="color: #5d5d5d;">Kraken</h3>
				</section>
				<section data-background="img/kraken.png" data-background-size="98%">
				</section>
				<section>
					<h3 style="color: #5d5d5d;">Tig</h3>
					<h4 style="color: #5d5d5d;">ncurses-based (GUI dans un terminal) text-mode interface</h4>
				</section>
				<section data-background="img/tig.png" data-background-size="80%">
					<h3 style="color: #5d5d5d; margin-top: -370px;">Tig</h3>
				</section>
				<section>
					<h3 style="color: #5d5d5d;">IntelliJ</h3>
					<h4 style="color: #5d5d5d;">Faire des beaux commits atomiques ! (Démo)</h4>
					<p>git add --patch (ou -p)</p>
					<aside class="notes">
						Montrer les "git commit --patch"
					</aside>
				</section>
				<section>
					<h3>Avantages</h3>
					<h4>Git pour les null</h4>
					<ul>
						<li>Facile à prendre en main</li>
						<li>Pas de commandes à apprendre</li>
						<li>Représentation visuel de l'arbre de branches Git</li>
						<li>C'est quand même pas moche...</li>
					</ul>
				</section>
				<section>
					<h3>Inconvénients</h3>
					<ul>
						<li>On ne sait pas ce qu'il y a sous le capot</li>
						<li>Besoin d'un compte fabriquant</li>
						<li>Erreurs pas toujours compréhensibles</li>
					</ul>
				</section>
			</section>

			<!-- Pimp My Git! -->
			<section>
				<section>
					<h2>Pimp My Git!</h2>
					<aside class="notes">
					</aside>
				</section>
				<section>
					<h2>Aliases</h2>
					<pre><code>[alias]
	  co = checkout							
	  st = status --short --branch
	  mr = !sh -c 'git fetch $1 merge-requests/$2/head:mr-$1-$2 && git checkout mr-$1-$2' -
	  out = log @{u}..
	  in  = log ..@{u}</code></pre>
					<aside class="notes">
					</aside>
				</section>
				<section>
					<h2>Hook</h2>
					<ul>
						<li>pre-commit</li>
						<li>prepare-commit-msg</li>
						<li>post-checkout</li>
					</ul>
					<aside class="notes">
					</aside>
				</section>
				<section>
					<h2>Mon premier plugin !</h2>
					<pre><code>#!/bin/zsh
								
	c=$(git branch | grep -c "$1")
								
	if [[ "$c" -eq 1 ]]; then
		git checkout $(git branch | grep "$1")
	else
		echo "'$1' is ambigus"
		git branch | grep "$1"
		exit 1
	fi</code></pre>
					<aside class="notes">
					</aside>
				</section>
				<section>
					<h2>Plugins</h2>
					<ul>
						<li>git-svn</li>
						<li>octopussy</li>
						<li>git-git</li>
						<li>
							<a href="https://github.com/unixorn/git-extra-commands#included-scripts" />pleins d'autres</a>
						</li>
					</ul>
					<aside class="notes">
					</aside>
				</section>
			</section>

			<!-- Quelques scénarios -->
			<!-- TODO : remplir les scénarios -->
			<section>
				<section>
					<h2>Quelques scénarios</h2>
					<aside class="notes">
					</aside>
				</section>
				<section>
					/!\ TODO /!\

					Scénario non géré par git avec du code mort qui a été supprimé dans une branche et est utilisé dans une autre,
					comment git gère-t-il le merge ? (ex de moi qui supprime systématiquement le code mort)

					Scénario de merge avec des conflits, pourquoi les modifs qui ne sont pas conflits sont à tratiter manuellement
					dans un fichier en conflit.

					In case of fire git commit -am "" & git push

					Déplacer un fichier ET modifier son contenu => git considérera que le fichier original a été supprimé et qu'un
					nouveau a été créé. Solution : faire deux commits distincts (à noter que ce n'est pas le cas si on ne fait que
					renommer le fichier et pas le déplacer)

					CRLF, LF, CR

					Rebase over rebase la gestion des conflits identiques encore et encore... (revoir comment reproduire ça)

				</section>
				<section></section>
			</section>

			<!-- Les outils autour de git -->
			<section>
				<section>
					<h2>Les outils autour de git</h2>
					<aside class="notes">
					</aside>
				</section>
				<section>
					<h2>Repository management services</h2>
					<h4>Github, Gitlab, Bitbucket, Gogs, Coding...</h4>
				</section>
				<section>
					<img src="img/gitlab-logo.png" alt="gitlab" width="30%">
				</section>
				<section data-background="img/Capture-gitLab.png" data-background-size="98%">
				</section>
				<section>
					<h2>What else ?</h2>
					<ul>
						<li>Stockage des source centralisé</li>
						<li>Gestion des utilisateurs</li>
						<li>Pull request</li>
						<li>Fork</li>
					</ul>
				</section>
				<section>
					<h2>Intégration continue</h2>
					<h4>Jenkins, VSTS, Gitlab-CI...</h4>
				</section>
			</section>

			<!-- REX et bonnes pratiques -->
			<!-- TODO : remplir bonnes pratiques -->
			<section>
				<section>
					<h2>REX et bonnes pratiques</h2>
					<aside class="notes">
					</aside>
				</section>
				<section>
					<h2>Quelques scénarios</h2>
				</section>
				<section></section>
			</section>

			<!-- Dissection d'un commit -->
			<section>
				<section>
					<h2>Dissection d'un commit</h2>
					<h4>Git, c'est magique!</h4>
					<img src="img/unicorn.png" style="border: none; box-shadow: none" width="40%">
				</section>
				<section>
					<h2>Avez vous déjà vu ...</h2>
					<p>Un commit de Michel</p>
					<pre>
						<code data-trim>
 commit 8684d0560cb7c51234cbefebd83409e90cb7e29f
 Author: Michel michel.xxxx@viseo.com
 Date:   Wed Dec 6 12:40:14 2017 +0100

"Init presentation"
</code>
</pre>
					<aside class="notes">
						Vous avez sans doute déjà vu un commit.
						Vous vous etes déja demandé pourquoi les "numéros" de commit sont aussi long ?
						Et puis, pouquoi est ce que deux commit consécutifs n'ont pas un simple incrément dans leurs numéros ?
					</aside>
				</section>
				<section>
					<h2>git hash</h2>
					<h3>algorithme sha-1</h3>
					<img src="img/git-hache.png" style="border: none; box-shadow: none" alt="hash" />
					<aside class="notes">
					</aside>
				</section>
				<section>
					<h2>"Hasher" un commit</h2>
					<pre>
						<code data-trim>
sha1(
  commit_message,
  commiter,
  commit_date,
  author,
  authoring_date,
  <span style="background-color: rgb(252, 252, 252)">Hash-Of-Entire-Working-Directory</span>
)
				</code>
			</pre>
				</section>
				<section>
					<h2>Hash-Of-Entire-Working-Directory ?</h2>
					<img src="IMG/wtf.gif" />
				</section>
				<section>
					<h3>Exemple : myProjet</h3>
					<h4>Ce que
						<span style="color: steelblue">nous</span> voyons</h4>
					<pre><code>
 .
 │ main.java
 │
 ├───.git
 └───resources
 │     logo.png
 └───components
       ...
				</code></pre>
				</section>
				<section>
					<h3>Exemple : myProjet</h3>
					<h4>Ce que
						<span style="color: steelblue">git</span> voit</h4>
					<img src="img/git-tree.png" alt="tree" style="border: none; box-shadow: none" />
					<aside class="notes">
						Si on part du bas. Les fichiers comme logo.png sont représentés par des blobs dans git.
						Ces blobs passent par la fonction de hash et en résulte un identifiant unique.
						Les repertoires sont représentés par des arbres (tree).
						Ils servent de dictionnaire entre les noms des fichiers contenus dans un repertoire et leurs hashs respectifs.
					</aside>
				</section>
				<section>
					<h2>Hashons notre commit</h2>
					<pre>
						<code>
sha1(

"Init presentation"

michel.xxxx@viseo.com
Wed Dec 6 12:40:14 2017 +0100

michel.xxxx@viseo.com
Wed Dec 6 12:40:14 2017 +0100

<span style="background-color: whitesmoke">aa1b2fb696a831c89c53f787e03d863691d2b671</span>
)
				</code>
			</pre>
				</section>
				<section>
					<h2>Mais ça sert à quoi ?</h2>
				</section>
				<section>
					<h2>Conserver
						<span style="color: coral">l'intégrité</span> des données
					</h2>
					<h3></h3>
					<aside class="notes">
						Tous ces hashage permettent de garantir l'intégrité des fichiers sur toutes les machines qui possèdent un même
						repository.
						De plus, cela permet à git de détecter le moindre changement et de l'indiquer à l'utilisateur. Enfin,
						l'intégrité
						même
						de l'historique est conservé grace au hash du commit parent présent de son ou ses commits enfants.
					</aside>
				</section>
				<section>
					<h2>Hash du commit parent</h2>
					<pre>
							<code data-trim>
sha1(
 meta data
 commit_message
 commiter
 commit_date
 author
 authoring_date
 Hash-Of-Entire-Working-Directory
 <span style="background-color: whitesmoke">hash-of-parent-commit</span>
)
					</code>
				</pre>
					<aside class="notes">
						Enfin, l'intégrité même de l'historique est conservé grace au hash du commit parent présent dans ses commits
						enfants.
					</aside>
				</section>
				<section>
					<h2>On est tous le(a) fils(fille) de quelqu'un...</h2>
					<img class="plain strech" src="img/flow-parent-history.svg" />
					<aside class="notes">
					</aside>
				</section>
			</section>

			<!-- Pour approfondir le sujet -->
			<!-- TODO : remplir -->
			<section>

			</section>

			<!-- Gource -->

			<!-- Ciao ! -->
			<!-- TODO : remplir -->
			<section>
				<h2>Licence</h2>
				Pour ce qui concerne tous les contenus que nous avons produits dans cette présentation :
				<a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">
					<img alt="Licence Creative Commons" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/4.0/88x31.png" />
				</a>
				<a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">
					licence Creative Commons Attribution - Pas d’Utilisation Commerciale 4.0 International
				</a>.
				<br />Fondé(e) sur une œuvre à
				<a xmlns:dct="http://purl.org/dc/terms/" href="https://github.com/barmic/viseo-take-an-hour_cassandra.git" rel="dct:source">https://github.com/barmic/viseo-take-an-hour_cassandra.git</a>.
			</section>

			<!-- Ressources -->
			<!-- TODO : remplir -->
			<section>

			</section>
		</div>
	</div>
	<script src="lib/js/head.min.js"></script>
	<script src="js/reveal.js"></script>

	<script>
		// Required, even if empty.
		Reveal.initialize({
			dependencies: [
				{ src: 'plugin/notes/notes.js', async: true },
				{ src: 'plugin/tagcloud/tagcloud.js', async: true }
			],
			// slideNumber: 'c/t', // Absolute slide numbers (with total).
			slideNumber: true, // Enable hierarchical slide numbers
			history: true // Enable slide number in URL fragment
		});
		// Automatic fragment numbering
		var fragmentNumbering = function (event) {
			var fragments = $(event.currentSlide).find('.fragment');
			var order = new Array(fragments.length);

			$(fragments).filter('[data-index]').each(function () {
				var index = parseInt($(this).attr('data-index')) - 1;
				if (index < 0 || index >= order.length) {
					alert('Invalid data-index: ' + index);
					return;
				}
				if (typeof order[index] == 'undefined') {
					order[index] = [$(this)];
				} else {
					order[index].push($(this));
				}
			});

			var index = 0;
			$(fragments).not('[data-index]').each(function () {
				while (typeof order[index] != 'undefined') {
					index = index + 1;
				}
				order[index] = [$(this)];
			});

			$(order).each(function (index) {
				$(this).each(function () {
					$(this).attr('data-fragment-index', index);
				})
			});
		};
		Reveal.addEventListener('ready', fragmentNumbering);
		Reveal.addEventListener('slidechanged', fragmentNumbering);

		hljs.initHighlightingOnLoad();

		function vidplay(vidId) {
			var video = document.getElementById(vidId);
			if (video.paused) {
				video.play();
			}
		}
	</script>
</body>

</html>